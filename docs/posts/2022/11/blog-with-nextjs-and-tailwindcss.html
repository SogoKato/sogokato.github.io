<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/favicon.ico"/><title>Next.jsとTailwind CSSでブログを作るときに考えたこと - Sogo.dev</title><meta name="description" content="
このブログは Next.js の SSG（Static Site Generation; 静的サイト生成）機能を使いながら、デザインの大半は Tailwind CSS を使用して整えています。そして生成された HTML, CSS, JS は GitHub Pages でホストさせてもらっています。

そこそこの出来栄えになったので、今回はこのブログができるまでのお話をしたいなと思ったのですが、正直なところ、以下のリンク先のページを~~まるパク~~参考にさせてもらいながら作成したので、具体的な構築方法についてはそちらをご覧いただけると良いかと思います。1ステップずつ丁寧に解説されておりとても有"/><meta property="og:url" content="https://sogo.dev/posts/2022/11/blog-with-nextjs-and-tailwindcss"/><meta property="og:type" content="article"/><meta property="og:title" content="Next.jsとTailwind CSSでブログを作るときに考えたこと - Sogo.dev"/><meta property="og:description" content="
このブログは Next.js の SSG（Static Site Generation; 静的サイト生成）機能を使いながら、デザインの大半は Tailwind CSS を使用して整えています。そして生成された HTML, CSS, JS は GitHub Pages でホストさせてもらっています。

そこそこの出来栄えになったので、今回はこのブログができるまでのお話をしたいなと思ったのですが、正直なところ、以下のリンク先のページを~~まるパク~~参考にさせてもらいながら作成したので、具体的な構築方法についてはそちらをご覧いただけると良いかと思います。1ステップずつ丁寧に解説されておりとても有"/><meta property="og:site_name" content="Sogo.dev"/><meta property="og:image" content="https://sogo.dev/images/ogp-image.jpg"/><meta name="twitter:card" content="summary"/><meta name="next-head-count" content="12"/><link rel="preconnect" href="https://use.typekit.net" crossorigin /><link rel="preload" href="/_next/static/css/a2df5b928396bd6c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/a2df5b928396bd6c.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-a7920ce216a1a736.js" defer=""></script><script src="/_next/static/chunks/framework-03665ce53a58c61e.js" defer=""></script><script src="/_next/static/chunks/main-3055cbf3b70fa9b9.js" defer=""></script><script src="/_next/static/chunks/pages/_app-3c27ef63c1850db8.js" defer=""></script><script src="/_next/static/chunks/1-2e22884f98519a83.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5B...slug%5D-e444b857c8064c94.js" defer=""></script><script src="/_next/static/M8yCa8rDrorsRnQrW0qR7/_buildManifest.js" defer=""></script><script src="/_next/static/M8yCa8rDrorsRnQrW0qR7/_ssgManifest.js" defer=""></script><style data-href="https://use.typekit.net/suf5fdm.css">@import url("https://p.typekit.net/p.css?s=1&k=suf5fdm&ht=tk&f=18518&a=11062204&app=typekit&e=css");@font-face{font-family:"rooney-sans";src:url("https://use.typekit.net/af/c27ef1/00000000000000007735a2d8/30/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n9&v=3") format("woff2"),url("https://use.typekit.net/af/c27ef1/00000000000000007735a2d8/30/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n9&v=3") format("woff"),url("https://use.typekit.net/af/c27ef1/00000000000000007735a2d8/30/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n9&v=3") format("opentype");font-display:auto;font-style:normal;font-weight:900;font-stretch:normal}.tk-rooney-sans{font-family:"rooney-sans",sans-serif}</style></head><body><div id="__next"><div class="bg-neutral-200 dark:bg-neutral-900 duration-400 min-h-screen text-neutral-900 dark:text-neutral-50 transition-all"><div class="grid grid-cols-10 justify-center max-w-7xl mx-auto"><header class="col-span-10"><div class="max-w-4xl mt-4 sm:mt-0 mx-auto flex justify-center sm:justify-between h-36 sm:h-48 items-center relative w-11/12"><div class="hidden sm:block"></div><a class="w-72 sm:w-auto" href="/"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27480%27%20height=%27160%27/%3e"/></span><img alt="logo" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="logo" src="/images/logo.svg" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></a></div></header><main class="col-span-10 md:col-span-7"><article><div class="bg-white dark:bg-neutral-700 mx-auto mb-11 p-8 rounded-3xl shadow-lg w-11/12"><div><p>2022<!-- -->年<!-- -->11<!-- -->月<!-- -->13<!-- -->日</p><h1 class="mb-3 font-bold mt-3 text-4xl">Next.jsとTailwind CSSでブログを作るときに考えたこと</h1><ul class="flex flex-wrap mb-1"><a class="bg-duchs-100 hover:bg-duchs-500 font-bold mb-2 mr-3 px-5 py-1 rounded-full dark:text-neutral-900 hover:text-neutral-50 hover:dark:text-neutral-50 text-xs transition-all" href="/tags/javascript"># <!-- -->JavaScript</a><a class="bg-duchs-100 hover:bg-duchs-500 font-bold mb-2 mr-3 px-5 py-1 rounded-full dark:text-neutral-900 hover:text-neutral-50 hover:dark:text-neutral-50 text-xs transition-all" href="/tags/react"># <!-- -->React</a><a class="bg-duchs-100 hover:bg-duchs-500 font-bold mb-2 mr-3 px-5 py-1 rounded-full dark:text-neutral-900 hover:text-neutral-50 hover:dark:text-neutral-50 text-xs transition-all" href="/tags/next.js"># <!-- -->Next.js</a><a class="bg-duchs-100 hover:bg-duchs-500 font-bold mb-2 mr-3 px-5 py-1 rounded-full dark:text-neutral-900 hover:text-neutral-50 hover:dark:text-neutral-50 text-xs transition-all" href="/tags/tailwind-css"># <!-- -->Tailwind CSS</a></ul><div class="my-5 prose dark:prose-invert prose-neutral"><p>このブログは Next.js の SSG（Static Site Generation; 静的サイト生成）機能を使いながら、デザインの大半は Tailwind CSS を使用して整えています。そして生成された HTML, CSS, JS は GitHub Pages でホストさせてもらっています。</p>
<p>そこそこの出来栄えになったので、今回はこのブログができるまでのお話をしたいなと思ったのですが、正直なところ、以下のリンク先のページを<del>まるパク</del>参考にさせてもらいながら作成したので、具体的な構築方法についてはそちらをご覧いただけると良いかと思います。1ステップずつ丁寧に解説されておりとても有用でした🙏</p>
<ul>
<li><a href="https://reffect.co.jp/react/nextjs-markdown-blog">Next.jsを利用した初めての本格的Markdownブログサイトの構築</a></li>
</ul>
<p>なので、今回は技術的な詳細というよりも、筆者が始める前に疑問だった点や技術選定、設計まわりについて書ければなと思います。</p>
<h2>対象読者</h2>
<ul>
<li>自分のブログを作ってみたい人</li>
<li>React や Next.js に興味がある人</li>
</ul>
<h2>ブログをどこでホストするか</h2>
<p>技術に関する記事を書くのであれば Qiita や Zenn でいいじゃんと思いますし、実際その方がはるかに楽で、多くのリアクションをもらいやすいと思います。そんな中、自分のブログを作る理由としては「やってみたかったから」以上の理由は存在しません。つまりロマンです。</p>
<p>しかしながら、いざ自分のブログを作ろうと思ったときに</p>
<ul>
<li>簡単に、かつ高度なカスタマイズができる</li>
<li>ランニングコストが安い</li>
</ul>
<p>といった美味しい環境は思ったよりも少ないです。</p>
<p>ブログを作ると言ったら WordPress が超定番ですが、テーマを作るとなると php や WordPress の知識が必要になります。WordPress テーマづくりに携わったことがあるので、やってみると思ったより簡単なのですが、筆者のお仕事の分野とはかすらないのであまりモチベーションが湧きません。<br/>
<!-- -->また、最低月数百円のランニングコストもかかりますし、動的にページを生成するのでレスポンスも遅くなりがちです。</p>
<p>次に SSG（Static Site Generation; 静的サイト生成）を検討します。Markdown で原稿を書き、静的な HTML などのファイルを出力すれば、GitHub Pages で無料で公開できるので結構良さそうです。</p>
<p>SSG のツールとしては有名なものがいくつかあります。</p>
<ul>
<li>Next.js</li>
<li>Gatsby</li>
<li>Hugo</li>
<li>NuxtJS</li>
<li>Jekyll</li>
</ul>
<p>このうち、Next.js と Gatsby は React ベースのため当初は検討から外していました。筆者は Hugo を選び、配布テーマを適用してみたり、自作テーマを作り始めたりしましたが、想像より学習コストが高かったので挫折してしまいました。</p>
<p>代わりに最近波に乗っていそうな Next.js を使ってみることにしました。React を使うのは初めてだったので（チュートリアルしかやったことがない）躊躇していましたが、<a href="https://reffect.co.jp/react/nextjs-markdown-blog">最初に紹介した記事</a>のおかげもあって、すんなりと構築することができました。React の基本的な知識さえあれば問題なさそうです。</p>
<h2>どうやってデザインするか</h2>
<p>まずは Adobe XD でデザインカンプを作成します。いきなりマークアップを始めても、作りたいものが定まっていないと無駄に時間がかかってしまうので、多少手間でも作りたいもののイメージを先に決めておくと良いです。</p>
<p><img src="/images/posts/2022/11/xd.png" alt="XD"/></p>
<p>上図のような感じで、ヘッダーやサイドバー、記事一覧、記事ページをざっくりと作りました。</p>
<h2>React の CSS よくわからん問題</h2>
<p>筆者の経験不足のせいなのですが、React で CSS でスタイルを適用するベストな方法がよくわかりませんでした😇</p>
<p>デザインカンプを作ってみて、そこまで複雑な CSS を記述する必要がなさそうだったので、Tailwind CSS を使ってみることにしました。</p>
<p><a href="https://tailwindcss.com/">Tailwind CSS</a> とは、HTML のクラス属性に <code>flex</code>, <code>pt-4</code>, <code>text-center</code> のようなクラス名を記述することで、<code>display: flex</code> をかけたり <code>padding-top</code> や <code>text-align: center</code> を設定できるというヤツです。</p>
<p>軽く個人的な感想をまとめてみると</p>
<p>Pros</p>
<ul>
<li>コード量が減る</li>
<li>HTML 要素を消したけど CSS は消し忘れた、みたいなことはなくなる</li>
<li>カスタムの色を設定できるなど、一定の柔軟性がある</li>
</ul>
<p>Cons</p>
<ul>
<li>CSS の知識は必要（それはそう）</li>
<li>都度リファレンスを見てクラス名を確認する必要がある</li>
<li>複雑なことはできないので割り切るか、別の方法で書かなくてはいけない</li>
</ul>
<p>な感じです。良いところも悪いところもありますが、今回筆者はアリだと判断して採用しましたし、実際良かったです。</p>
<h2>クライアント側で実行させたい処理どう書くの</h2>
<p>SSG で静的なページを書き出すと言っても、クライアント側で実行させたい処理はあります。このサイトでは、ライトモード↔︎ダークモード切り替えや「いいね」ボタンがそれに該当します。いずれもユーザーのアクションによって DOM を書き換える必要性があります。</p>
<p>普通に React のコンポーネントとして書いてしまうと SSG でのビルド時に静的なページとして書き出されてしまうため、なんとかする必要があります。最初は public ディレクトリ内に js ファイルを置いて Next.js の <a href="https://nextjs.org/docs/basic-features/script">Script</a> タグで読み込ませていたのですが、それよりも Next.js の <a href="https://nextjs.org/docs/advanced-features/dynamic-import">Dynamic Import</a> 機能を使った方がスマートに書けます。</p>
<p><code>{ ssr: false }</code> 引数を渡してあげることで、そのコンポーネントはブラウザ上でレンダリングされるようになります。</p>
<h2>GitHub Pages で公開するときの罠</h2>
<p>晴れて準備完了！いざ公開！と意気揚々と GitHub Pages にデプロイしても、うまくいかないことがあります。</p>
<p>ビルド時には以下のコマンドを実行しましょう。</p>
<pre><code>next build
next export -o docs/
touch docs/.nojekyll
echo &#x27;sogo.dev&#x27; &gt; docs/CNAME
</code></pre>
<p>ポイントは公開ディレクトリ（上記の場合は <code>docs</code>）の直下に <code>.nojekyll</code> というファイルを作成していることです。これがないと <code>_next</code> ディレクトリは以下が公開されずリンク切れになります。<br/>
<!-- -->参考: <a href="https://sidearrow.github.io/article/next-js-ssg-on-github-pages">Next.js の SSG 機能で生成した静的サイトを GitHub Actions 経由で GitHub Pages に公開する</a></p>
<p>最後のコマンドはカスタムドメイン名を使用しない場合は不要ですが、使用する場合は都度生成しておかないと消えてしまうため、カスタムドメイン名でアクセスできなくなります。</p>
<h2>今後やっていきたいこと</h2>
<p>以上がこのブログを作るにあたって考えたことなのですが、まだやり残したことはあります。</p>
<ul>
<li>記事をリッチにしたい<!-- -->
<ul>
<li>シンタックスハイライト</li>
<li>リンクカード</li>
<li>目次（ToC）</li>
</ul>
</li>
<li>おすすめ記事をいい感じのアルゴリズムで出したい<!-- -->
<ul>
<li>まずは記事を書きためなきゃ。。</li>
</ul>
</li>
</ul>
<h2>最後に</h2>
<p>つらつらと駄文を書き連ねてしまいました。勘の良い方は気づいていると思いますが、このブログは GitHub Pages でホストされている＝<a href="https://github.com/SogoKato/sogokato.github.io">ソースが見れる</a>なので、もし興味のある方がいらっしゃいましたら覗いてみてください。</p></div><ul class="flex flex-wrap mt-3"><a class="bg-duchs-100 hover:bg-duchs-500 font-bold mb-2 mr-3 px-5 py-1 rounded-full dark:text-neutral-900 hover:text-neutral-50 hover:dark:text-neutral-50 text-xs transition-all" href="/tags/javascript"># <!-- -->JavaScript</a><a class="bg-duchs-100 hover:bg-duchs-500 font-bold mb-2 mr-3 px-5 py-1 rounded-full dark:text-neutral-900 hover:text-neutral-50 hover:dark:text-neutral-50 text-xs transition-all" href="/tags/react"># <!-- -->React</a><a class="bg-duchs-100 hover:bg-duchs-500 font-bold mb-2 mr-3 px-5 py-1 rounded-full dark:text-neutral-900 hover:text-neutral-50 hover:dark:text-neutral-50 text-xs transition-all" href="/tags/next.js"># <!-- -->Next.js</a><a class="bg-duchs-100 hover:bg-duchs-500 font-bold mb-2 mr-3 px-5 py-1 rounded-full dark:text-neutral-900 hover:text-neutral-50 hover:dark:text-neutral-50 text-xs transition-all" href="/tags/tailwind-css"># <!-- -->Tailwind CSS</a></ul></div></div><div class="flex flex-col sm:flex-row justify-between mx-auto w-11/12"><div class="w-full sm:w-1/2"><a class="dark:hover:bg-neutral-600 hover:bg-neutral-300 flex group items-center rounded-full transition-all pr-10" href="/posts/2022/11/gitlab-rules-workflow"><div class="bg-duchs-200 group-hover:bg-duchs-800 flex items-center justify-center h-14 mx-5 first:ml-0 last:mr-0 px-3 rounded-full transition-all w-14"><svg class="fill-duchs-900 group-hover:fill-duchs-100" viewBox="0 0 10.19 8.33"><g><path d="M.31,4.9c-.11-.11-.19-.23-.24-.35s-.07-.25-.07-.37c0-.13,.02-.26,.07-.38s.13-.24,.24-.35L3.45,.32c.09-.09,.19-.17,.29-.23s.22-.09,.36-.09,.27,.03,.4,.09,.24,.14,.33,.24,.17,.21,.23,.33,.08,.25,.08,.38-.03,.25-.08,.35-.13,.21-.23,.3l-.87,.89c-.11,.11-.22,.22-.34,.32s-.24,.19-.36,.28h5.99c.15,0,.29,.03,.4,.08s.22,.12,.3,.21,.14,.2,.18,.32,.06,.25,.06,.39-.02,.26-.06,.38-.1,.22-.18,.31-.18,.16-.3,.21-.25,.08-.4,.08H3.42c.12,.09,.25,.18,.37,.28s.23,.2,.34,.32l.76,.79c.1,.1,.18,.2,.23,.31s.08,.22,.08,.34c0,.14-.03,.28-.1,.41s-.15,.25-.26,.36-.22,.19-.36,.25-.27,.09-.4,.09c-.12,0-.23-.03-.34-.08s-.21-.13-.31-.23L.31,4.9Z"></path></g></svg></div><div class=""><p class="line-clamp-1 mb-1">GitLab CIのrulesとworkflowを理解する</p><p class="text-neutral-500">2022<!-- -->年<!-- -->11<!-- -->月<!-- -->17<!-- -->日</p></div></a></div><div class="w-full sm:w-1/2"><a class="dark:hover:bg-neutral-600 hover:bg-neutral-300 flex group items-center rounded-full transition-all pl-10 justify-end" href="/posts/2022/10/hello-world"><div class="text-end"><p class="line-clamp-1 mb-1">Hello World!</p><p class="text-neutral-500">2022<!-- -->年<!-- -->10<!-- -->月<!-- -->11<!-- -->日</p></div><div class="bg-duchs-200 group-hover:bg-duchs-800 flex items-center justify-center h-14 mx-5 first:ml-0 last:mr-0 px-3 rounded-full transition-all w-14"><svg class="fill-duchs-900 group-hover:fill-duchs-100" viewBox="0 0 10.19 8.33"><g><path d="M6.77,3.16c-.12-.09-.25-.18-.37-.28s-.23-.2-.34-.32l-.76-.79c-.1-.1-.18-.2-.23-.31s-.08-.22-.08-.34c0-.14,.03-.28,.1-.41s.15-.25,.26-.36,.22-.19,.36-.25,.27-.09,.4-.09c.12,0,.23,.03,.34,.08s.21,.13,.31,.23l3.12,3.12c.11,.11,.19,.23,.24,.35s.07,.25,.07,.37c0,.13-.02,.26-.07,.38s-.13,.24-.24,.35l-3.13,3.13c-.09,.09-.19,.17-.29,.23s-.22,.09-.36,.09-.27-.03-.4-.09-.24-.14-.33-.24-.17-.21-.23-.33-.08-.25-.08-.38,.03-.25,.08-.35,.13-.21,.23-.3l.87-.89c.11-.11,.22-.22,.34-.32s.24-.19,.36-.28H.95c-.15,0-.29-.03-.4-.08s-.22-.12-.3-.21-.14-.2-.18-.32-.06-.25-.06-.39,.02-.26,.06-.38,.1-.22,.18-.31,.18-.16,.3-.21,.25-.08,.4-.08H6.77Z"></path></g></svg></div></a></div></div></article></main><aside class="col-span-10 md:col-span-3 mx-auto w-11/12"><div class="mb-8"><h2 class="font-black font-display text-duchs-900 dark:text-duchs-100 text-xl">AUTHOR</h2><div class="flex items-center my-3.5"><div class="mr-2.5"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2780%27%20height=%2780%27/%3e"/></span><img alt="アイコン" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="rounded-full" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="アイコン" src="/images/icon.png" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="rounded-full" loading="lazy"/></noscript></span></div><div><p class="font-black font-display mb-2 text-duchs-900 dark:text-duchs-100 text-lg">Sogo Kato</p><div class="flex"><a class="mr-2 hover:opacity-75 transition-all" target="_blank" href="https://github.com/SogoKato"><div class="dark:hidden"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2720%27%20height=%2720%27/%3e"/></span><img alt="GitHubアイコン" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="GitHubアイコン" src="/images/github-light.svg" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div><div class="hidden dark:block"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%2720%27%20height=%2720%27/%3e"/></span><img alt="GitHubアイコン" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="GitHubアイコン" src="/images/github-dark.svg" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div></a></div></div></div><p class="mb-2.5 text-xs">クラウド業界に生息する駆け出しへっぽこエンジニア。ラズパイとダックスがすき。資格たくさんほしいので余ってる人はお裾分けください。</p><a href="/profile"><button class="bg-duchs-200 hover:bg-duchs-800 font-black font-display px-3.5 py-0.5 rounded-full text-duchs-900 hover:text-duchs-100 transition-all">MORE</button></a></div><div class="mb-8"><h2 class="font-black font-display text-duchs-900 dark:text-duchs-100 text-xl">RECOMMENDED</h2><ul class="mt-3.5"><a class="block mb-3 hover:opacity-75 transition-all" href="/posts/2022/11/gitlab-rules-workflow"><p class="mb-1 text-xs">GitLab CIのrulesとworkflowを理解する</p><p class="text-neutral-500 text-xs">2022<!-- -->年<!-- -->11<!-- -->月<!-- -->17<!-- -->日</p></a><a class="block mb-3 hover:opacity-75 transition-all" href="/posts/2022/11/blog-with-nextjs-and-tailwindcss"><p class="mb-1 text-xs">Next.jsとTailwind CSSでブログを作るときに考えたこと</p><p class="text-neutral-500 text-xs">2022<!-- -->年<!-- -->11<!-- -->月<!-- -->13<!-- -->日</p></a><a class="block mb-3 hover:opacity-75 transition-all" href="/posts/2022/10/hello-world"><p class="mb-1 text-xs">Hello World!</p><p class="text-neutral-500 text-xs">2022<!-- -->年<!-- -->10<!-- -->月<!-- -->11<!-- -->日</p></a></ul></div><div><h2 class="font-black font-display text-duchs-900 dark:text-duchs-100 text-xl">TAGS</h2><ul class="flex flex-wrap mt-3.5"><a class="bg-duchs-100 hover:bg-duchs-500 font-bold mb-2 mr-3 px-5 py-1 rounded-full dark:text-neutral-900 hover:text-neutral-50 hover:dark:text-neutral-50 text-xs transition-all" href="/tags/gitlab"># <!-- -->Gitlab</a><a class="bg-duchs-100 hover:bg-duchs-500 font-bold mb-2 mr-3 px-5 py-1 rounded-full dark:text-neutral-900 hover:text-neutral-50 hover:dark:text-neutral-50 text-xs transition-all" href="/tags/ci-cd"># <!-- -->CI/CD</a><a class="bg-duchs-100 hover:bg-duchs-500 font-bold mb-2 mr-3 px-5 py-1 rounded-full dark:text-neutral-900 hover:text-neutral-50 hover:dark:text-neutral-50 text-xs transition-all" href="/tags/javascript"># <!-- -->JavaScript</a><a class="bg-duchs-100 hover:bg-duchs-500 font-bold mb-2 mr-3 px-5 py-1 rounded-full dark:text-neutral-900 hover:text-neutral-50 hover:dark:text-neutral-50 text-xs transition-all" href="/tags/react"># <!-- -->React</a><a class="bg-duchs-100 hover:bg-duchs-500 font-bold mb-2 mr-3 px-5 py-1 rounded-full dark:text-neutral-900 hover:text-neutral-50 hover:dark:text-neutral-50 text-xs transition-all" href="/tags/next.js"># <!-- -->Next.js</a><a class="bg-duchs-100 hover:bg-duchs-500 font-bold mb-2 mr-3 px-5 py-1 rounded-full dark:text-neutral-900 hover:text-neutral-50 hover:dark:text-neutral-50 text-xs transition-all" href="/tags/tailwind-css"># <!-- -->Tailwind CSS</a><a class="bg-duchs-100 hover:bg-duchs-500 font-bold mb-2 mr-3 px-5 py-1 rounded-full dark:text-neutral-900 hover:text-neutral-50 hover:dark:text-neutral-50 text-xs transition-all" href="/tags/personal"># <!-- -->Personal</a></ul></div></aside><footer class="col-span-10"><div class="flex flex-col items-center py-10"><a class="mb-2 text-xs" href="/privacy">プライバシーポリシー</a><small>Copyright © <!-- -->2022<!-- --> Sogo Kato All rights reserved.</small></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"posts":[{"title":"GitLab CIのrulesとworkflowを理解する","date":"2022-11-17T00:00:00.000Z","ref":"/posts/2022/11/gitlab-rules-workflow","desc":"\nGitLab CI の rules を使って Dockerfile などの特定のファイルの変更時のみ Docker イメージを作成するパイプラインを回して、それ以外の時には既存の Docker イメージを使用して CI を実行する、という組み方をしたかったのですが、書き方に結構手間取ったのでメモ。\n\n環境: GitLab.com 15.6.0-pre\n\n## rules とは\n\nhttps://docs.gitlab.com/ee/ci/yaml/#rules\n\nそれぞれのジョブについて、パイプラインに追加するかしないかの条件を記述するものです。\n\nrules では下記の条件が指定できます。","draft":false,"content":"\nGitLab CI の rules を使って Dockerfile などの特定のファイルの変更時のみ Docker イメージを作成するパイプラインを回して、それ以外の時には既存の Docker イメージを使用して CI を実行する、という組み方をしたかったのですが、書き方に結構手間取ったのでメモ。\n\n環境: GitLab.com 15.6.0-pre\n\n## rules とは\n\nhttps://docs.gitlab.com/ee/ci/yaml/#rules\n\nそれぞれのジョブについて、パイプラインに追加するかしないかの条件を記述するものです。\n\nrules では下記の条件が指定できます。\n\n* `if`\n* `changes`\n* `exists`\n* `allow_failure`\n* `variables`\n* `when`\n\nそれぞれの条件の詳細については公式ドキュメントを参照してください。\n\nrules は [only/except](https://docs.gitlab.com/ee/ci/yaml/#only--except) を置き換えるものなので、rules と only/except を同じジョブで同時に指定することはできません。\n\nrules の指定の一例を公式ドキュメントから引用します。\n\n```yaml\ndocker build:\n  script: docker build -t my-image:$CI_COMMIT_REF_SLUG .\n  rules:\n    - if: $CI_PIPELINE_SOURCE == \"merge_request_event\"\n      changes:\n        - Dockerfile\n      when: manual\n      allow_failure: true\n```\n\n上記の例では\n\n* パイプラインがマージリクエストのパイプラインの時に `Dockerfile` が変更されているか確認する\n* `Dockerfile` が変更されている時に、ジョブをパイプラインにマニュアルジョブとして追加する\n  * `allow_failure: true` によって、ジョブがトリガーされなかったとしても後続のジョブが実行される\n* `Dockerfile` が変更されていない時は、ジョブをパイプラインに追加しない\n  * `when: never` と同じ\n\nという挙動になります。\n\nrules はリストなので複数のルールを書くことができますが、 **短絡評価である** 点に注意が必要です。rules はパイプラインが作成されたタイミングで評価され、最初にマッチするまで評価が行われます。そのため、例えば `- when: manual` を最初に記述するとそこで評価が終わり（`manual` は常に真となりパイプラインに追加されます）、その後の条件については評価されません。言われてみたらそれはそうなのですが、筆者はそこでしばらく詰まってました。\n\n## workflow とは\n\nhttps://docs.gitlab.com/ee/ci/yaml/workflow.html\n\nパイプラインそのものを実行するかどうかを決定するものです。workflow で条件にマッチしなかった場合、そのパイプライン内のジョブが実行されることはありません。\n\nよくある使い方としては `$CI_PIPELINE_SOURCE` の種類（`merge_request_event`, `push`, `schedule`, etc.）に応じてパイプラインを実行するかしないかを決めると言った使い方があります。\n\n```yaml\nworkflow:\n  rules:\n    - if: $CI_PIPELINE_SOURCE == \"schedule\"\n      when: never\n    - if: $CI_PIPELINE_SOURCE == \"push\"\n      when: never\n    - when: always\n```\n\n上記の例ではスケジュール実行時または push 時（ブランチとタグ）には `when: never` が指定されているためパイプラインは走りません。それ以外の時にはパイプラインが実行されます。\n\n## 重複したパイプラインを避ける\n\nhttps://docs.gitlab.com/ee/ci/jobs/job_control.html#avoid-duplicate-pipelines\n\nジョブに rules を使用していると、マージリクエスト作成後にブランチに対して push するといった1つのアクションが、push 時に発生したパイプラインとマージリクエストのパイプラインの2つが走らせることが起こりえます。\n\n重複したパイプライン（duplicate pipelines）を避けるためには\n\n* workflow を使ってどの種類のパイプラインは走って良いのかを指定する\n* ジョブが実行される条件をかなり限定的にして、最後のルールとして `when`（`when: never` 以外）を使うのを避ける\n\nことが対策になります。\n\n筆者の場合は、次項で示す例を書いている際に重複したパイプラインが発生し、片方のジョブは正しく機能しないという状況が起こりましたが、workflow を指定することで重複が解消され、正しく機能するようになりました。\n\n## 特定ファイルの変更時のみジョブを実行し、それ以外はスキップして後続のジョブを実行する\n\n`.gitlab-ci.yml` と同階層に `Dockerfile` がある想定です。\n\n```yaml\nstages:\n  - build\n  - test\n\nworkflow:\n  rules:\n    - if: $CI_PIPELINE_SOURCE == \"merge_request_event\"\n    - if: $CI_COMMIT_BRANCH \u0026\u0026 $CI_OPEN_MERGE_REQUESTS\n      when: never\n    - if: $CI_COMMIT_BRANCH\n\nbuild:\n  stage: build\n  image:\n    name: gcr.io/kaniko-project/executor:v1.9.0-debug\n    entrypoint: [\"\"]\n  script:\n    - /kaniko/executor\n      --context \"${CI_PROJECT_DIR}\"\n      --dockerfile \"${CI_PROJECT_DIR}/Dockerfile\"\n      --destination \"${CI_REGISTRY_IMAGE}:latest\"\n  rules:\n    - if: $CI_PIPELINE_SOURCE =~ /merge_request_event|push/\n      changes:\n        - Dockerfile\n    - when: manual\n      allow_failure: true\n\ntest:\n  stage: test\n  image: \"${CI_REGISTRY_IMAGE}:latest\"\n  script:\n    - echo \"DO SOME TESTS\"\n```\n\n上記の例は以下の挙動をします。\n\n* workflow\n  * マージリクエストでのパイプラインの場合は実行される\n  * マージリクエストがある時、ブランチへの push イベントでのパイプラインは実行されない\n  * それ以外のブランチへの push イベントでは実行される\n* rules\n  * パイプラインがマージリクエストのパイプラインの時または push された時に `Dockerfile` が変更されているか確認する\n    * changes は上記以外では常に真となってしまうため\n  * `Dockerfile` が変更されている時に、ジョブをパイプラインにジョブを追加する\n  * 上記の条件に当てはまらない時はマニュアルジョブとしてパイプラインに追加する\n    * `allow_failure: true` となっているので、後続のジョブはそのまま実行される\n\nこのように書くことで、実現したかった「特定ファイルの変更時のみジョブを実行し、それ以外はスキップして後続のジョブを実行する」が実現します。\n","tags":[{"name":"Gitlab","ref":"/tags/gitlab"},{"name":"CI/CD","ref":"/tags/ci-cd"}]},{"title":"Next.jsとTailwind CSSでブログを作るときに考えたこと","date":"2022-11-13T00:00:00.000Z","ref":"/posts/2022/11/blog-with-nextjs-and-tailwindcss","desc":"\nこのブログは Next.js の SSG（Static Site Generation; 静的サイト生成）機能を使いながら、デザインの大半は Tailwind CSS を使用して整えています。そして生成された HTML, CSS, JS は GitHub Pages でホストさせてもらっています。\n\nそこそこの出来栄えになったので、今回はこのブログができるまでのお話をしたいなと思ったのですが、正直なところ、以下のリンク先のページを~~まるパク~~参考にさせてもらいながら作成したので、具体的な構築方法についてはそちらをご覧いただけると良いかと思います。1ステップずつ丁寧に解説されておりとても有","draft":false,"content":"\nこのブログは Next.js の SSG（Static Site Generation; 静的サイト生成）機能を使いながら、デザインの大半は Tailwind CSS を使用して整えています。そして生成された HTML, CSS, JS は GitHub Pages でホストさせてもらっています。\n\nそこそこの出来栄えになったので、今回はこのブログができるまでのお話をしたいなと思ったのですが、正直なところ、以下のリンク先のページを~~まるパク~~参考にさせてもらいながら作成したので、具体的な構築方法についてはそちらをご覧いただけると良いかと思います。1ステップずつ丁寧に解説されておりとても有用でした🙏\n\n* [Next.jsを利用した初めての本格的Markdownブログサイトの構築](https://reffect.co.jp/react/nextjs-markdown-blog)\n\nなので、今回は技術的な詳細というよりも、筆者が始める前に疑問だった点や技術選定、設計まわりについて書ければなと思います。\n\n## 対象読者\n\n* 自分のブログを作ってみたい人\n* React や Next.js に興味がある人\n\n## ブログをどこでホストするか\n\n技術に関する記事を書くのであれば Qiita や Zenn でいいじゃんと思いますし、実際その方がはるかに楽で、多くのリアクションをもらいやすいと思います。そんな中、自分のブログを作る理由としては「やってみたかったから」以上の理由は存在しません。つまりロマンです。\n\nしかしながら、いざ自分のブログを作ろうと思ったときに\n\n* 簡単に、かつ高度なカスタマイズができる\n* ランニングコストが安い\n\nといった美味しい環境は思ったよりも少ないです。\n\nブログを作ると言ったら WordPress が超定番ですが、テーマを作るとなると php や WordPress の知識が必要になります。WordPress テーマづくりに携わったことがあるので、やってみると思ったより簡単なのですが、筆者のお仕事の分野とはかすらないのであまりモチベーションが湧きません。  \nまた、最低月数百円のランニングコストもかかりますし、動的にページを生成するのでレスポンスも遅くなりがちです。\n\n次に SSG（Static Site Generation; 静的サイト生成）を検討します。Markdown で原稿を書き、静的な HTML などのファイルを出力すれば、GitHub Pages で無料で公開できるので結構良さそうです。\n\nSSG のツールとしては有名なものがいくつかあります。\n\n* Next.js\n* Gatsby\n* Hugo\n* NuxtJS\n* Jekyll\n\nこのうち、Next.js と Gatsby は React ベースのため当初は検討から外していました。筆者は Hugo を選び、配布テーマを適用してみたり、自作テーマを作り始めたりしましたが、想像より学習コストが高かったので挫折してしまいました。\n\n代わりに最近波に乗っていそうな Next.js を使ってみることにしました。React を使うのは初めてだったので（チュートリアルしかやったことがない）躊躇していましたが、[最初に紹介した記事](https://reffect.co.jp/react/nextjs-markdown-blog)のおかげもあって、すんなりと構築することができました。React の基本的な知識さえあれば問題なさそうです。\n\n## どうやってデザインするか\n\nまずは Adobe XD でデザインカンプを作成します。いきなりマークアップを始めても、作りたいものが定まっていないと無駄に時間がかかってしまうので、多少手間でも作りたいもののイメージを先に決めておくと良いです。\n\n![XD](/images/posts/2022/11/xd.png)\n\n上図のような感じで、ヘッダーやサイドバー、記事一覧、記事ページをざっくりと作りました。\n\n## React の CSS よくわからん問題\n\n筆者の経験不足のせいなのですが、React で CSS でスタイルを適用するベストな方法がよくわかりませんでした😇\n\nデザインカンプを作ってみて、そこまで複雑な CSS を記述する必要がなさそうだったので、Tailwind CSS を使ってみることにしました。\n\n[Tailwind CSS](https://tailwindcss.com/) とは、HTML のクラス属性に `flex`, `pt-4`, `text-center` のようなクラス名を記述することで、`display: flex` をかけたり `padding-top` や `text-align: center` を設定できるというヤツです。\n\n軽く個人的な感想をまとめてみると\n\nPros\n* コード量が減る\n* HTML 要素を消したけど CSS は消し忘れた、みたいなことはなくなる\n* カスタムの色を設定できるなど、一定の柔軟性がある\n\nCons\n* CSS の知識は必要（それはそう）\n* 都度リファレンスを見てクラス名を確認する必要がある\n* 複雑なことはできないので割り切るか、別の方法で書かなくてはいけない\n\nな感じです。良いところも悪いところもありますが、今回筆者はアリだと判断して採用しましたし、実際良かったです。\n\n## クライアント側で実行させたい処理どう書くの\n\nSSG で静的なページを書き出すと言っても、クライアント側で実行させたい処理はあります。このサイトでは、ライトモード↔︎ダークモード切り替えや「いいね」ボタンがそれに該当します。いずれもユーザーのアクションによって DOM を書き換える必要性があります。\n\n普通に React のコンポーネントとして書いてしまうと SSG でのビルド時に静的なページとして書き出されてしまうため、なんとかする必要があります。最初は public ディレクトリ内に js ファイルを置いて Next.js の [Script](https://nextjs.org/docs/basic-features/script) タグで読み込ませていたのですが、それよりも Next.js の [Dynamic Import](https://nextjs.org/docs/advanced-features/dynamic-import) 機能を使った方がスマートに書けます。\n\n`{ ssr: false }` 引数を渡してあげることで、そのコンポーネントはブラウザ上でレンダリングされるようになります。\n\n## GitHub Pages で公開するときの罠\n\n晴れて準備完了！いざ公開！と意気揚々と GitHub Pages にデプロイしても、うまくいかないことがあります。\n\nビルド時には以下のコマンドを実行しましょう。\n\n```\nnext build\nnext export -o docs/\ntouch docs/.nojekyll\necho 'sogo.dev' \u003e docs/CNAME\n```\n\nポイントは公開ディレクトリ（上記の場合は `docs`）の直下に `.nojekyll` というファイルを作成していることです。これがないと `_next` ディレクトリは以下が公開されずリンク切れになります。  \n参考: [Next.js の SSG 機能で生成した静的サイトを GitHub Actions 経由で GitHub Pages に公開する](https://sidearrow.github.io/article/next-js-ssg-on-github-pages)\n\n最後のコマンドはカスタムドメイン名を使用しない場合は不要ですが、使用する場合は都度生成しておかないと消えてしまうため、カスタムドメイン名でアクセスできなくなります。\n\n## 今後やっていきたいこと\n\n以上がこのブログを作るにあたって考えたことなのですが、まだやり残したことはあります。\n\n* 記事をリッチにしたい\n  * シンタックスハイライト\n  * リンクカード\n  * 目次（ToC）\n* おすすめ記事をいい感じのアルゴリズムで出したい\n  * まずは記事を書きためなきゃ。。\n\n## 最後に\n\nつらつらと駄文を書き連ねてしまいました。勘の良い方は気づいていると思いますが、このブログは GitHub Pages でホストされている＝[ソースが見れる](https://github.com/SogoKato/sogokato.github.io)なので、もし興味のある方がいらっしゃいましたら覗いてみてください。\n","tags":[{"name":"JavaScript","ref":"/tags/javascript"},{"name":"React","ref":"/tags/react"},{"name":"Next.js","ref":"/tags/next.js"},{"name":"Tailwind CSS","ref":"/tags/tailwind-css"}]},{"title":"Hello World!","date":"2022-10-11T00:00:00.000Z","ref":"/posts/2022/10/hello-world","desc":"\nはじめまして。  \nこれは初めての投稿です。\n\n今までブログが長く続いたことがないのですが、n度目の正直ということで今回こそは長く続くように頑張りたいと思います（とても固い決意）。\n\n@SogoKato といいます。どんな人か気になってくれた方は 自己紹介ページ をご覧いただければと思います。\n\nこのブログの制作にあたっては、初めて React + Next.js + Tailwind CSS を触って作ってみましたが、結構いい開発者体験だったのでこれについてもまた記事に起こしていきたいな〜と思っています。。（少しゆるい決意）\n\n今まで書いてきた記事については、[私の","draft":false,"content":"\nはじめまして。  \nこれは初めての投稿です。\n\n今までブログが長く続いたことがないのですが、n度目の正直ということで今回こそは長く続くように頑張りたいと思います（とても固い決意）。\n\n@SogoKato といいます。どんな人か気になってくれた方は [自己紹介ページ](/profile) をご覧いただければと思います。\n\nこのブログの制作にあたっては、初めて React + Next.js + Tailwind CSS を触って作ってみましたが、結構いい開発者体験だったのでこれについてもまた記事に起こしていきたいな〜と思っています。。（少しゆるい決意）\n\n今まで書いてきた記事については、[私の Qiita](https://qiita.com/SogoK) を見てみてください。  \nおすすめは↓らへんです。\n\n* [Vue 3から始める人のための学習ロードマップ](https://qiita.com/SogoK/items/15ed0d9b2be4279b2f47)\n* [新卒エンジニアがCKA取得を目指してKubernetesを勉強したときの記録](https://qiita.com/SogoK/items/4ed2e118d0412c868169)\n* [GitLabのタブを開きすぎて見分けづらいのでfaviconを変える拡張機能を作った](https://qiita.com/SogoK/items/31f74b517dc3c6884c04)\n\nさて、初回から頑張りすぎると次回以降の心理的なハードルがあがっちゃうのでこれくらいにしておこうと思います。では、これからよろしくお願いします🙏\n","tags":[{"name":"Personal","ref":"/tags/personal"}]}],"post":{"title":"Next.jsとTailwind CSSでブログを作るときに考えたこと","date":"2022-11-13T00:00:00.000Z","ref":"/posts/2022/11/blog-with-nextjs-and-tailwindcss","desc":"\nこのブログは Next.js の SSG（Static Site Generation; 静的サイト生成）機能を使いながら、デザインの大半は Tailwind CSS を使用して整えています。そして生成された HTML, CSS, JS は GitHub Pages でホストさせてもらっています。\n\nそこそこの出来栄えになったので、今回はこのブログができるまでのお話をしたいなと思ったのですが、正直なところ、以下のリンク先のページを~~まるパク~~参考にさせてもらいながら作成したので、具体的な構築方法についてはそちらをご覧いただけると良いかと思います。1ステップずつ丁寧に解説されておりとても有","draft":false,"content":"\nこのブログは Next.js の SSG（Static Site Generation; 静的サイト生成）機能を使いながら、デザインの大半は Tailwind CSS を使用して整えています。そして生成された HTML, CSS, JS は GitHub Pages でホストさせてもらっています。\n\nそこそこの出来栄えになったので、今回はこのブログができるまでのお話をしたいなと思ったのですが、正直なところ、以下のリンク先のページを~~まるパク~~参考にさせてもらいながら作成したので、具体的な構築方法についてはそちらをご覧いただけると良いかと思います。1ステップずつ丁寧に解説されておりとても有用でした🙏\n\n* [Next.jsを利用した初めての本格的Markdownブログサイトの構築](https://reffect.co.jp/react/nextjs-markdown-blog)\n\nなので、今回は技術的な詳細というよりも、筆者が始める前に疑問だった点や技術選定、設計まわりについて書ければなと思います。\n\n## 対象読者\n\n* 自分のブログを作ってみたい人\n* React や Next.js に興味がある人\n\n## ブログをどこでホストするか\n\n技術に関する記事を書くのであれば Qiita や Zenn でいいじゃんと思いますし、実際その方がはるかに楽で、多くのリアクションをもらいやすいと思います。そんな中、自分のブログを作る理由としては「やってみたかったから」以上の理由は存在しません。つまりロマンです。\n\nしかしながら、いざ自分のブログを作ろうと思ったときに\n\n* 簡単に、かつ高度なカスタマイズができる\n* ランニングコストが安い\n\nといった美味しい環境は思ったよりも少ないです。\n\nブログを作ると言ったら WordPress が超定番ですが、テーマを作るとなると php や WordPress の知識が必要になります。WordPress テーマづくりに携わったことがあるので、やってみると思ったより簡単なのですが、筆者のお仕事の分野とはかすらないのであまりモチベーションが湧きません。  \nまた、最低月数百円のランニングコストもかかりますし、動的にページを生成するのでレスポンスも遅くなりがちです。\n\n次に SSG（Static Site Generation; 静的サイト生成）を検討します。Markdown で原稿を書き、静的な HTML などのファイルを出力すれば、GitHub Pages で無料で公開できるので結構良さそうです。\n\nSSG のツールとしては有名なものがいくつかあります。\n\n* Next.js\n* Gatsby\n* Hugo\n* NuxtJS\n* Jekyll\n\nこのうち、Next.js と Gatsby は React ベースのため当初は検討から外していました。筆者は Hugo を選び、配布テーマを適用してみたり、自作テーマを作り始めたりしましたが、想像より学習コストが高かったので挫折してしまいました。\n\n代わりに最近波に乗っていそうな Next.js を使ってみることにしました。React を使うのは初めてだったので（チュートリアルしかやったことがない）躊躇していましたが、[最初に紹介した記事](https://reffect.co.jp/react/nextjs-markdown-blog)のおかげもあって、すんなりと構築することができました。React の基本的な知識さえあれば問題なさそうです。\n\n## どうやってデザインするか\n\nまずは Adobe XD でデザインカンプを作成します。いきなりマークアップを始めても、作りたいものが定まっていないと無駄に時間がかかってしまうので、多少手間でも作りたいもののイメージを先に決めておくと良いです。\n\n![XD](/images/posts/2022/11/xd.png)\n\n上図のような感じで、ヘッダーやサイドバー、記事一覧、記事ページをざっくりと作りました。\n\n## React の CSS よくわからん問題\n\n筆者の経験不足のせいなのですが、React で CSS でスタイルを適用するベストな方法がよくわかりませんでした😇\n\nデザインカンプを作ってみて、そこまで複雑な CSS を記述する必要がなさそうだったので、Tailwind CSS を使ってみることにしました。\n\n[Tailwind CSS](https://tailwindcss.com/) とは、HTML のクラス属性に `flex`, `pt-4`, `text-center` のようなクラス名を記述することで、`display: flex` をかけたり `padding-top` や `text-align: center` を設定できるというヤツです。\n\n軽く個人的な感想をまとめてみると\n\nPros\n* コード量が減る\n* HTML 要素を消したけど CSS は消し忘れた、みたいなことはなくなる\n* カスタムの色を設定できるなど、一定の柔軟性がある\n\nCons\n* CSS の知識は必要（それはそう）\n* 都度リファレンスを見てクラス名を確認する必要がある\n* 複雑なことはできないので割り切るか、別の方法で書かなくてはいけない\n\nな感じです。良いところも悪いところもありますが、今回筆者はアリだと判断して採用しましたし、実際良かったです。\n\n## クライアント側で実行させたい処理どう書くの\n\nSSG で静的なページを書き出すと言っても、クライアント側で実行させたい処理はあります。このサイトでは、ライトモード↔︎ダークモード切り替えや「いいね」ボタンがそれに該当します。いずれもユーザーのアクションによって DOM を書き換える必要性があります。\n\n普通に React のコンポーネントとして書いてしまうと SSG でのビルド時に静的なページとして書き出されてしまうため、なんとかする必要があります。最初は public ディレクトリ内に js ファイルを置いて Next.js の [Script](https://nextjs.org/docs/basic-features/script) タグで読み込ませていたのですが、それよりも Next.js の [Dynamic Import](https://nextjs.org/docs/advanced-features/dynamic-import) 機能を使った方がスマートに書けます。\n\n`{ ssr: false }` 引数を渡してあげることで、そのコンポーネントはブラウザ上でレンダリングされるようになります。\n\n## GitHub Pages で公開するときの罠\n\n晴れて準備完了！いざ公開！と意気揚々と GitHub Pages にデプロイしても、うまくいかないことがあります。\n\nビルド時には以下のコマンドを実行しましょう。\n\n```\nnext build\nnext export -o docs/\ntouch docs/.nojekyll\necho 'sogo.dev' \u003e docs/CNAME\n```\n\nポイントは公開ディレクトリ（上記の場合は `docs`）の直下に `.nojekyll` というファイルを作成していることです。これがないと `_next` ディレクトリは以下が公開されずリンク切れになります。  \n参考: [Next.js の SSG 機能で生成した静的サイトを GitHub Actions 経由で GitHub Pages に公開する](https://sidearrow.github.io/article/next-js-ssg-on-github-pages)\n\n最後のコマンドはカスタムドメイン名を使用しない場合は不要ですが、使用する場合は都度生成しておかないと消えてしまうため、カスタムドメイン名でアクセスできなくなります。\n\n## 今後やっていきたいこと\n\n以上がこのブログを作るにあたって考えたことなのですが、まだやり残したことはあります。\n\n* 記事をリッチにしたい\n  * シンタックスハイライト\n  * リンクカード\n  * 目次（ToC）\n* おすすめ記事をいい感じのアルゴリズムで出したい\n  * まずは記事を書きためなきゃ。。\n\n## 最後に\n\nつらつらと駄文を書き連ねてしまいました。勘の良い方は気づいていると思いますが、このブログは GitHub Pages でホストされている＝[ソースが見れる](https://github.com/SogoKato/sogokato.github.io)なので、もし興味のある方がいらっしゃいましたら覗いてみてください。\n","tags":[{"name":"JavaScript","ref":"/tags/javascript"},{"name":"React","ref":"/tags/react"},{"name":"Next.js","ref":"/tags/next.js"},{"name":"Tailwind CSS","ref":"/tags/tailwind-css"}]}},"__N_SSG":true},"page":"/posts/[...slug]","query":{"slug":["2022","11","blog-with-nextjs-and-tailwindcss"]},"buildId":"M8yCa8rDrorsRnQrW0qR7","isFallback":false,"gsp":true,"scriptLoader":[{"async":true,"src":"https://www.googletagmanager.com/gtag/js?id=G-RE7Q7WBFDJ","strategy":"afterInteractive"},{"id":"_gtag","defer":true,"dangerouslySetInnerHTML":{"__html":"\n              window.dataLayer = window.dataLayer || [];\n              function gtag(){dataLayer.push(arguments);}\n              gtag(\"js\", new Date());\n              gtag(\"config\", \"G-RE7Q7WBFDJ\");"},"strategy":"afterInteractive"}]}</script></body></html>