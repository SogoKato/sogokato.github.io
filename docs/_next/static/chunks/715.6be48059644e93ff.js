"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[715],{9715:function(e,t,n){n.r(t),n.d(t,{default:function(){return r}});var o=n(1527),s=function(e,t,n,o){return new(n||(n=Promise))(function(s,i){function l(e){try{d(o.next(e))}catch(t){i(t)}}function a(e){try{d(o.throw(e))}catch(t){i(t)}}function d(e){var t;e.done?s(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(l,a)}d((o=o.apply(e,t||[])).next())})};class i{constructor(e,t){this.clientId=e,this.url="",this.pageId="",this.options=Object.assign({templateElement:"#headlessLikeTmpl",holderElements:".headlessLike",reactionNameElements:".headlessLike__name",reactionDescriptionElements:".headlessLike__desc",reactionCountElements:".headlessLike__count",stateElement:"button",clickedClassName:"clicked",clickedbeforeClassName:"clicked-before",baseUrl:"https://tcfqlqcnw3.execute-api.ap-northeast-1.amazonaws.com/production",localStorageKey:"headlessLikeRecords",pageIdFunc:l},t);let n=document.querySelector(this.options.templateElement);if(!n)throw Error("HeadlessLike: Your query selector for template finds no element.");if(!(n instanceof HTMLTemplateElement))throw Error("HeadlessLike: Got element other than HTMLTemplateElement.");this.templateElement=n;let o=document.querySelectorAll(this.options.holderElements);if(0===o.length)throw Error("HeadlessLike: Your query selector for holders finds no elements.");this.holderElements=o}static init(e,t={}){return s(this,void 0,void 0,function*(){let n=new i(e,t);n.pageId=yield n.options.pageIdFunc(),n.url=`${n.options.baseUrl}/${n.clientId}/${n.pageId}`;let o=yield fetch(n.url),s=yield o.json(),l=document.createDocumentFragment(),a=n.getHeadlessLikeRecords();return s.reactions.forEach(e=>{let t=n.templateElement.content.cloneNode(!0);if(!(t instanceof Element)&&!(t instanceof DocumentFragment))throw Error("HeadlessLike: Content of template is other than an Element or a DocumentFragment.");let o=t.querySelector(n.options.stateElement);if(!o)throw Error("HeadlessLike: Your query selector for state element finds no elements.");let s=t.querySelectorAll(n.options.reactionNameElements),i=t.querySelectorAll(n.options.reactionDescriptionElements),d=t.querySelectorAll(n.options.reactionCountElements);s.forEach(t=>t.textContent=e.name),d.forEach(t=>t.textContent=String(e.count)),i.forEach(t=>t.textContent=e.description),o.onclick=n.getOnClickFunc(e.id),o.dataset.reactionId=e.id,Object.keys(a).includes(n.pageId)&&a[n.pageId]===e.id?(o.disabled=!0,o.classList.add(n.options.clickedbeforeClassName)):Object.keys(a).includes(n.pageId)&&(o.disabled=!0);let r=document.createElement("div");r.appendChild(t),l.appendChild(r)}),n.holderElements.forEach(e=>{e.appendChild(l)}),n})}getOnClickFunc(e){return t=>s(this,void 0,void 0,function*(){this.options.preUpdate&&this.options.preUpdate(t);let n=t.target;if(!n.matches(this.options.stateElement))return;n.classList.add(this.options.clickedClassName),this.holderElements.forEach(e=>{let t=e.querySelectorAll(this.options.stateElement);t.forEach(e=>{e.disabled=!0})});let o=yield fetch(this.url,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({reactionId:e})}),s=yield o.json();this.holderElements.forEach(t=>{for(let n=0;n<t.children.length;n++){let o=t.children[n].querySelector(this.options.stateElement);if((null==o?void 0:o.dataset.reactionId)!==e)continue;let i=t.children[n].querySelectorAll(this.options.reactionCountElements);i.forEach(e=>e.textContent=String(s.reaction.count))}});let i=this.getHeadlessLikeRecords();i[this.pageId]=e,localStorage.setItem(this.options.localStorageKey,JSON.stringify(i)),this.options.postUpdate&&this.options.postUpdate(t,s.reaction.count)})}getHeadlessLikeRecords(){let e=localStorage.getItem(this.options.localStorageKey);return e?JSON.parse(e):{}}updateCounts(){return s(this,void 0,void 0,function*(){let e=yield fetch(this.url),t=yield e.json(),n=t.reactions.map(e=>e.id);this.holderElements.forEach(e=>{for(let o=0;o<e.children.length;o++){let s=e.children[o].querySelector(this.options.stateElement);if(!(null==s?void 0:s.dataset.reactionId))throw Error("HeadlessLike: Internal error occurred. No reaction id set on state element.");let i=n.indexOf(null==s?void 0:s.dataset.reactionId);if(console.log(s,i,n),-1===i)continue;let l=e.children[o].querySelectorAll(this.options.reactionCountElements);l.forEach(e=>e.textContent=String(t.reactions[i].count))}})})}clearRecords(){localStorage.removeItem(this.options.localStorageKey)}destroy(){this.holderElements.forEach(e=>e.innerHTML="")}}function l(){return s(this,void 0,void 0,function*(){let e=window.location.pathname,t=new TextEncoder().encode(e),n=yield crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map(e=>e.toString(16).padStart(2,"0")).join("")})}var a=n(3331),d=n.n(a);function r(){var e=document.createElement("style");return e.innerText="\n    .headlessLike__item:disabled {\n      background-color: #A3A3A3;\n      box-shadow: none;\n    }\n\n    .headlessLike__item:disabled .headlessLike__name {\n      background-color: #E5E5E5;\n    }\n\n    html.dark .headlessLike__item:disabled {\n      background-color: #737373;\n    }\n\n    html.dark .headlessLike__item:disabled .headlessLike__name {\n      background-color: #A3A3A3;\n    }\n\n    .headlessLike__item:not(:disabled):hover,\n    .headlessLike__item.clicked:disabled,\n    .headlessLike__item.clicked-before:disabled {\n      background-color: #E38634;\n      box-shadow: none;\n    }\n\n    html.dark .headlessLike__item:not(:disabled):hover,\n    html.dark .headlessLike__item.clicked:disabled,\n    html.dark .headlessLike__item.clicked-before:disabled {\n      background-color: #824007;\n    }\n\n    .headlessLike__item:not(:disabled):hover .headlessLike__name,\n    .headlessLike__item.clicked:disabled .headlessLike__name,\n    .headlessLike__item.clicked-before:disabled .headlessLike__name {\n      background-color: #FFEEE8;\n    }\n\n    html.dark .headlessLike__item:not(:disabled):hover .headlessLike__name,\n    html.dark .headlessLike__item.clicked:disabled .headlessLike__name,\n    html.dark .headlessLike__item.clicked-before:disabled .headlessLike__name {\n      background-color: #EBD6CF;\n    }\n  ",document.getElementsByTagName("head")[0].insertAdjacentElement("beforeend",e),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{id:"likeMessage",className:"max-w-xs mx-auto my-5 text-center",children:"＼ いいねしてもらえると喜びます！ ／"}),(0,o.jsx)("div",{className:"headlessLike flex flex-wrap justify-between max-w-xs mx-auto my-5"}),(0,o.jsx)("template",{id:"headlessLikeTmpl",dangerouslySetInnerHTML:{__html:'<button class="headlessLike__item bg-duchs-500 flex font-bold items-center p-2 rounded-lg shadow-neutral-500 shadow text-neutral-50 transition-all">\n          <div class="headlessLike__name bg-neutral-50 flex items-center justify-center h-8 mr-1 rounded-full text-lg transition-all w-8"></div>\n          <div class="headlessLike__desc mr-2"></div>\n          <div class="headlessLike__count"></div>\n          </button>'}}),(0,o.jsx)(d(),{src:"https://cdn.jsdelivr.net/npm/@noroch/like-widget@1.0.0/dist/main.min.js",onLoad:function(){i.init("58fcbf0d-e6c1-4e2d-a56f-f95aa56d5be4",{postUpdate:function(e,t){var n=document.getElementById("likeMessage");n&&(n.textContent="いつもありがとうございます！")}}).then(function(e){if(document.querySelectorAll(".headlessLike__item.clicked-before").length>0){var t=document.getElementById("likeMessage");t&&(t.textContent="いつもありがとうございます！")}})}})]})}n(959)}}]);